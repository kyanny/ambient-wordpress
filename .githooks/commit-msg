#!/bin/bash

echo -e "\033[37;1mğŸª Running Git Hooks: commit-msg\033[0m"

# ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å®šç¾©

MSG="$(cat "$1")"
readonly MSG

# çµ‚äº†ã‚³ãƒ¼ãƒ‰ã‚’å®šç¾©ã€‚0: OK, 1: NG

code=0

# issue ç•ªå·ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯

echo -en " - issue ç•ªå·ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯: "
readonly ISSUE_NO="\#[1-9]"
if ! echo "$MSG" | grep -q "${ISSUE_NO}"; then
echo -e "\033[31;22mNG"
echo -e "================================================================"
echo -e "ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã« issue ç•ªå·ãŒå«ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚"
echo -e ""
echo -e "Example: #1234"
echo -e "================================================================\033[0m\n"
code=1
else
echo -e "\033[32;22mOK\033[0m"
fi

# çµ‚äº†å®£è¨€

if [ ${code} -eq 0 ]; then
echo ""
echo -e "\033[32;1mâœ¨ALL PASS!!\033[0m\n\n"
else
echo ""
echo -e "\033[31;1mGit Hooks: commit-msg: NG\033[0m\n\n"
fi

exit ${code}
